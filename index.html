<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Bing Maps API</title>
    <script type='text/javascript' src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-3.3.1.js"></script>
    <script type='text/javascript' src='https://www.bing.com/api/maps/mapcontrol?key=AgQe2codsceRhvGnZ_OlNODabFk63lKz6HvtU4nOVbUDT8Ov89D3EHDbYxsnMppl'></script>
    <script type='text/javascript' src='https://www.bing.com/api/maps/mapcontrol?key=AgQe2codsceRhvGnZ_OlNODabFk63lKz6HvtU4nOVbUDT8Ov89D3EHDbYxsnMppl&callback=loadMapScenario'
        async defer></script>
    <script type='text/javascript'>
        var map;
        var searchManager;
        function loadMapScenario() {
            map = new Microsoft.Maps.Map(document.getElementById('myMap'), {});
            Microsoft.Maps.loadModule('Microsoft.Maps.Search', function () {
                searchManager = new Microsoft.Maps.Search.SearchManager(map);
            });
        }
        $(document).ready(function () {
            $('#searchButton').click(function (e) {
                var requestOptions = {
                    bounds: map.getBounds(),
                    where: $('#searchInput').val(),
                    callback: function (answer, userData) {
                        map.setView({ bounds: answer.results[0].bestView });
                        map.entities.push(new Microsoft.Maps.Pushpin(answer.results[0].location));
                    }
                };
                searchManager.geocode(requestOptions);
            });
            $('#reverseSearchButton').click(function (e) {
                var items = $('#searchInput').val().split(',');
                var lat = parseFloat(items[0]);
                var lon = parseFloat(items[1]);
                console.log(items);
                var reverseGeocodeRequestOptions = {
                    location: new Microsoft.Maps.Location(lat, lon),
                    callback: function (answer, userData) {
                        map.setView({ bounds: answer.bestView });
                        map.entities.push(new Microsoft.Maps.Pushpin(reverseGeocodeRequestOptions.location));
                        document.getElementById('printoutPanel').innerHTML =
                            answer.address.formattedAddress;
                    }
                };
                searchManager.reverseGeocode(reverseGeocodeRequestOptions);
            });
        });
    </script>
</head>

<body onload='loadMapScenario()' style='margin: 0'>
    <input id='searchInput' style='position: absolute; left: 1em; top: 1em; width: 20em; z-index: 999'>
    <button title='Find location by name' id='searchButton' style='position: absolute; left: 21em; top: 1em; width: 3em; z-index: 999'>&#x1F50D</button>
    <button title='Find location by latitude and longitude' id='reverseSearchButton' style='position: absolute; left: 24em; top: 1em; width: 3em; z-index: 999'>&#x1F50D</button>
    <div id='myMap' style='width: 100vw; height: 100vh;'></div>
</body>

</html>
